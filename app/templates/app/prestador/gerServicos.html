{% extends "app/geral/layout.html" %}
 {% load staticfiles %}
{% block content %}
{% load humanize %}
<script src="{% static 'sistema/scripts/jquery-1.9.1.min.js' %}" type="text/javascript"></script>
<script type="text/javascript">
 
 $(document).ready(function () {

     $('#vTodos').on('click', function () {
         $('#AP').fadeIn('fast')
         $('#CP').fadeIn('fast')
         $('#EX').fadeIn('fast')
         $('#AV').fadeIn('fast')
         $('#AG').fadeIn('fast')
     });

     $('#vAgendados').on('click', function () {
         $('#AP').fadeOut('fast')
         $('#CP').fadeOut('fast')
         $('#EX').fadeOut('fast')
         $('#AV').fadeOut('fast')
         $('#AG').fadeIn('fast')
     });

     $('#vPendentes').on('click', function () {
         $('#AG').fadeOut('fast')
         $('#CP').fadeOut('fast')
         $('#EX').fadeOut('fast')
         $('#AV').fadeOut('fast')
         $('#AP').fadeIn('fast')
     });

     $('#vCancelados').on('click', function () {
         $('#AG').fadeOut('fast')
         $('#AP').fadeOut('fast')
         $('#EX').fadeOut('fast')
         $('#AV').fadeOut('fast')
         $('#CP').fadeIn('fast')
         $('#CC').fadeIn('fast')
     });

     $('#vAvaliados').on('click', function () {
         $('#AG').fadeOut('fast')
         $('#CP').fadeOut('fast')
         $('#EX').fadeOut('fast')
         $('#AA').fadeOut('fast')
         $('#AV').fadeIn('fast')
     });
 });

</script>
<div class="span3">
{% include "app/geral/menu.html" %}
</div>
<div class="span9">
    <div class="content">
	<div class="module">
            <div class="module-head">
                <h3> Gerenciando os Serviços</h3>
                
            </div>
        <br />
        <div class="btn-group btn-group-justified span9" style="border:0px solid;display: block;align:center;" role="group">
								
              <button class="btn btn-success" role="group" id="vTodos">	Todos </button>
                                  <button class="btn btn-warning" role="group" id="vPendentes">	Pendentes </button>
                	              <button class="btn btn-info" role="group" id="vAgendados">	Agendados </button>	
                                  <button class="btn btn-danger" role="group" id="vCancelados">	Cancelados </button>	
								  <button class="btn btn-primary btn" role="group" id="vExecutados">Executados </button>		
                                  <button class="btn btn-default" role="group" id="vAvaliados">	Avaliados </button>		
				  			  
				</div>
             <hr> <br />	
            {% if msg %}
                    {% include "app/geral/feedbackUser/msgSucesso.html" %}
            {% endif %}

            {% if servicos %}
            <div class="module-body table">
                 <table cellpadding="0" cellspacing="0" border="0" class="datatable-1 table table-bordered"
                    width="100%" style="table-layout: fixed;word-wrap:break-word;">
                    <thead>
                        <tr style="text-align:center;">
                            <th> 
                                Categoria / Subcategoria
                            </th>   
                            
                            <th>
                                Data
                            </th>
                            
                            <th>
                                Qt. Horas / Valor Total
                            </th>
                             <th>
                                Cliente
                            </th>

                            <th>
                                Observações
                            </th>
                            <th style="width:10%;">
                                Ações
                            </th>
                        </tr>
                    </thead>
                    <tbody>

                        
                        {% for servico in servicos %}
                                
                                    
                                    <div>
                                     <strong>Serviço:</strong>    {{ servico.IdServico.IdCategoria.DescricaoCategoria }}{{ servico.IdServico.IdSubCategoria.DescricaoSubCategoria }}
                                    <strong>Situação:</strong>
                                        {% if servico.Situacao == "AP"%} 
                                            <span class="warning" id="AP"> Aguardando Aprovação </span>
                                        {% endif %}
                                       
                                        {% if servico.Situacao == "AG"%} 
                                            <span class="info" id="AG"> Aceito e Agendado </span>
                                        {% endif %}
                                        {% if servico.Situacao == "CP"%} 
                                            <span class="danger" id="CP"> Cancelado pelo Prestador </span>
                                        {% endif %}
                                        {% if servico.Situacao == "CC"%} 
                                            <span class="danger" id="CC"> Cancelado pelo Contratante </span>
                                        {% endif %}
                                        {% if servico.Situacao == "EX"%} 
                                            <span class="primary" id="EX"> Executado </span>
                                        {% endif %}
                                        {% if servico.Situacao == "AV"%} 
                                            <span class="default" id="AV"> Avaliado </span>
                                        {% endif %}
                                    </div>
                                   <td align="center">
                                        {{ servico.IdServico.IdCategoria.DescricaoCategoria }} - {{ servico.IdServico.IdSubCategoria.DescricaoSubCategoria }}
                                    </td>
                                 
                                    <td>
                                        {{ servico.DataServico | date:"d/M/Y"}}
                                       
                                    </td>
                                    
                                    <td class="center">
                                         {% if servico.IdServico.IndicadorTipoServico = 1 %} 
                                         {{ servico.QtHoras}} horas <br>  Hora: R$ {{ servico.ValorHora | floatformat:2|intcomma }}
                                        <b>Total: R$ {{ servico.ValorTotal | floatformat:2|intcomma}}</>
                                       {% else %}
                                        Voluntário
                                       {% endif %}
                                    </td>
                                    <td>

                                         {{ servico.IdUsuario.Nome}}

                                    </td>
                                    <td>
                                         {{ servico.IdUsuario.IdEndereco.Logradouro}}, {{ servico.IdUsuario.IdEndereco.Numero}} - Bairro: {{ servico.IdUsuario.IdEndereco.Bairro}} - Cidade/UF: {{ servico.IdUsuario.IdEndereco.Cidade}}/{{ servico.IdUsuario.IdEndereco.Estado}}      
                                         {{ servico.Descricao}}

                                    </td>


                                    <td class="center">
                                    <!-- ACEITAR SERVICO -->
                                    <div style="float:left;display:inline-block;" >
                                        
                                        <a href="aceitarServico/?id={{servico.IdClienteServico}}" title="Aceitar" style="margin-left: 10px;">
                                        <img src="{% static 'sistema/images/icons/ok.png'%}" width="25px"/>
                                        </a>
                                        

                                        
                                        <a href="executarServico/?id={{servico.IdClienteServico}}" title="Serviço Executado" style="margin-left: 10px;">
                                        <img src="{% static 'sistema/images/icons/execute.png'%}" width="25px"/>
                                        </a>
                                        
                                    <!-- CANCELAR -->
						            <a href="cancelarServicoP/?id={{servico.IdClienteServico}}" title="Cancelar" style="margin-left: 10px;">
                                        <img src="{% static 'sistema/images/icons/cancelar.png'%}" width="25px" alt="Editar" />
                                    </a>
                                         </div>
						            </td>
                                    

                                </tr>
                      {% endfor %}
                        </table>
                        
                    {% endif %}
                        
                    {% if not servicos %}    
                        <h3> N&atilde;o existem serviços aguardando aprovação</h3>
                    {% endif %}
                <hr />
			</div>
		</div>
        
	</div><!--/.content-->
</div><!--/.span9-->

            <!-- Modal -->
          <div class="modal fade" id="myModal" role="dialog" style="display: inline-block;">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">{{title}}</h4>
                </div>
                <div class="modal-body" >
                 
                     <form class="form-horizontal row-fluid" id="formServico" action="i_servico" method="POST">
                    {% csrf_token %}
    	             {% if frmServico %}
				    	<div class="control-group" >
						  <div class="controls" style="display: inline-block;margin-left:100px;">
                                              {{ frmServico }}
							</div>
						</div>  
                     {% else %}
                        Erro ao carregar formulário.
                     {% endif %}
						
                </div>
                <div class="modal-footer">
                   <button type="button" class="span1 btn btn-danger" data-dismiss="modal" style="float:right;margin-left:3;">Cancelar</button>			
					            <button type="submit" class="span1 btn btn-primary" style="float:right;">Gravar</button>
                    </form>      
                </div>
              </div>
            </div>
           </div>
{% endblock %}         		                